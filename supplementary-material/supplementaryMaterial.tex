\documentclass[a4paper,10pt,reqno,oneside]{amsart}
\usepackage[small]{caption}
\usepackage[usenames,dvipsnames]{color}
\usepackage[colorlinks=TRUE,linkcolor=Black,urlcolor=Black,citecolor=Black,pagebackref=TRUE,]{hyperref} %Have to change href email.
\usepackage{amsfonts,fancyhdr,graphicx,lastpage,rotating,multirow,fixltx2e, stfloats,txfonts,palatino,url,xcolor,multicol,hanging, setspace,lscape, paralist, changepage,subcaption,array,verbatim,setspace, tikz, listings, geometry, siunitx}
\usepackage[pagewise, displaymath, mathlines]{lineno}
%\usepackage{epstopdf}
\geometry{verbose,a4paper,tmargin=25mm,bmargin=25mm,lmargin=28mm,rmargin=28mm}

\renewcommand{\theequation}{eqn S\arabic{equation}}
\makeatletter
\def\tagform@#1{\maketag@@@{\ignorespaces#1\unskip\@@italiccorr}}
\makeatother

\renewcommand\thefigure{S\arabic{figure}} 
\renewcommand\thetable{S\arabic{table}}     

\renewcommand{\thesection}{S\arabic{section}}   

% A list of supporting information
% S1 A table
% S2 Mathematical appendix
% S3 Python script
% S4 R Script

% simulation script?


\lstset{
language=R,
basicstyle=\scriptsize\ttfamily,
commentstyle=\ttfamily\color{gray},
numbers=left,
numberstyle=\ttfamily\color{gray}\footnotesize,
stepnumber=1,
numbersep=5pt,
backgroundcolor=\color{white},
showspaces=false,
showstringspaces=false,
showtabs=false,
frame=single,
tabsize=2,
captionpos=b,
breaklines=true,
breakatwhitespace=false,
title=\lstname,
escapeinside={},
keywordstyle={},
morekeywords={},
  keywordstyle=\color{red},          % keyword style
  commentstyle=\color{gray},       % comment style
  stringstyle=\color{blue},         % string literal style 
}

\definecolor{Code}{rgb}{0,0,0}
\definecolor{Decorators}{rgb}{0.5,0.5,0.5}
\definecolor{Numbers}{rgb}{0.5,0,0}
\definecolor{MatchingBrackets}{rgb}{0.25,0.5,0.5}
\definecolor{Keywords}{rgb}{0,0,1}
\definecolor{self}{rgb}{0,0,0}
\definecolor{Strings}{rgb}{0,0.63,0}
\definecolor{Comments}{rgb}{0,0.63,1}
\definecolor{Backquotes}{rgb}{0,0,0}
\definecolor{Classname}{rgb}{0,0,0}
\definecolor{FunctionName}{rgb}{0,0,0}
\definecolor{Operators}{rgb}{0,0,0}
\definecolor{Background}{rgb}{0.98,0.98,0.98}

\lstnewenvironment{python}[1][]{
\lstset{
numbers=left,
numberstyle=\footnotesize,
numbersep=1em,
xleftmargin=1em,
framextopmargin=2em,
framexbottommargin=2em,
showspaces=false,
showtabs=false,
showstringspaces=false,
frame=l,
tabsize=4,
% Basic
basicstyle=\ttfamily\small\setstretch{1},
backgroundcolor=\color{Background},
language=Python,
% Comments
commentstyle=\color{Comments}\slshape,
% Strings
stringstyle=\color{Strings},
morecomment=[s][\color{Strings}]{"""}{"""},
morecomment=[s][\color{Strings}]{'''}{'''},
% keywords
morekeywords={import,from,class,def,for,while,if,is,in,elif,else,not,and,or,print,break,continue,return,True,False,None,access,as,,del,except,exec,finally,global,import,lambda,pass,print,raise,try,assert},
keywordstyle={\color{Keywords}\bfseries},
% additional keywords
morekeywords={[2]@invariant},
keywordstyle={[2]\color{Decorators}\slshape},
emph={self},
emphstyle={\color{self}\slshape},
%
}}{}

%\setcounter{tocdepth}{2}

%\linenumbers
%\doublespacing

\setcounter{totalnumber}{1}

\usepackage[sort&compress,comma]{natbib}



% This declares the unit "animals". Also redefined days to be whole word *(not sure if thats what is needed.
\DeclareSIUnit{\animals}{animals}
\DeclareSIUnit{\day}{days}



\input{../tikzREMmethods.tex}



\begin{document}

\title[Supp. Info, Lucas \emph{et al.}: A generalised random encounter model for animals]{Supplementary Information: A generalised random encounter model for estimating animal density with remote sensor data}
\maketitle



\section{Table of symbols}

%move to appendix
\begin{table}[h!]
\centering
\begin{tabular}{lll}
Symbol 	& Description & Units\\\hline
$v$		& Velocity & \SI{}{\meter\per\second}\\
$\theta$	& Angle of detection & Radians \\
$\alpha$	& Animal call/beam width & Radians \\
$r$ 		& Detection distance & Metres\\
$\bar{p}$ 		& Average profile width & Metres\\
$p$ 		& A specific profile width & Metres\\
$t$		& Time & Seconds\\
$z$		& Number of detections & \\
$D$		& Animal density & \SI{}{\animals\per\meter\squared} \\
$x_i$	        & Focal Angle $i \in \{1,2,3,4\} $ 	& Radians\\
$T$ 		& Step length & Seconds\\
$N$ 		& Number of steps per simulation & \\
$d$ 		& Time step index &\\
$S$ 		& Probability of remaining stationary & \\
$A$ 		& Probabilty of changing direction & \\

\end{tabular}
\caption{List of symbols used to describe the gREM}
\label{t:paras}
\end{table}

\clearpage

\section{Supplementary Methods}
\subsection{Introduction}
This supplementary methods derives all the models used in the paper. For continuity, the gas model derivation is included here as well as in the main text. The calculation of all integrals is included in the Python script S3. 




\input{/home/tim/Dropbox/liz-paper/lucasMoorcroftManuscript/supplementary-material/REM-methods.tex}


\clearpage
\section{Supplementary Script: Symbolic algebra Python Script}
This script uses the SymPy package \cite{sympy}, a computer algebra system to calculate the equations for $p$ in the various models and to perform unit checks on the results.

\lstinputlisting{REM-Analysis.py}


\clearpage
\section{Supplementary Script: R implementation of models}

This is a simple implementation of the models derived in the paper in R \citep{R}. Once given the parameters $\theta$ and $\alpha$ it automatically selects the correct model to apply.

\lstinputlisting{supplementaryRscript.R}

\bibliographystyle{../mee.bst}	
\bibliography{../lucas-moorcroft-etal-refs.bib}	

\end{document}


